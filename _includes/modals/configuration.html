{% assign id = "configurationModal" %}
{% assign title = "Main configuration" %}
{% capture content %}

<div class="form-group">
    <div class="form-row">
        <div class="col">
            <input id="bgExampleWidth" type="number" class="form-control" placeholder="Preview width (eg. 1280)">
        </div>
        <div class="col">
            <input id="bgExampleHeight" type="number" class="form-control" placeholder="Preview height (eg. 682)">
        </div>
    </div>
    <small id="bg-example-help" class="form-text text-muted">Examples: 
        <a href="#" class="preview-size-example">1920x1080</a>, 
        <a href="" class="preview-size-example">1280x682</a>, 
        <a href="" class="preview-size-example">1024x768</a>
    </small>
</div>

<div class="form-group" modal-save="bgExampleModalSaved" modal-show="bgExampleModalShowed">
    <label for="bg-example">Preview background</label>
    <select id="bg-example" class="form-control" aria-describedby="bg-example-help"></select>
    <small id="bg-example-help" class="form-text text-muted">Will not be added to result JSON</small>
</div>

<div class="form-group">
    <img src="/assets/images/screen1.jpg" width="450" id="bg-example-preview">
</div>

{% endcapture %}
{% include modals/_template.html content=content id=id title=title %}

<script type="module">
    import { previewImages, previewConfig, previewUpdate } from '/assets/scripts/editor.js';
    var dialog = $("#{{id}}");

    $(function () {
        var i = 1;
        previewImages.forEach((e) => {
            $("#bg-example").append('<option value="' + e + '">Picture ' + (i++) + '</option>');
        });

        dialog.on("show.bs.modal", onShowed);
        $("form", dialog).on("submit", onSaved);

        $("#bg-example").on("change", updatePreviewImage);
        $(".preview-size-example").on("click", presetSize);
    })

    function onShowed() {
        $("#bg-example").val(previewConfig.image);
        $("#bgExampleWidth").val(previewConfig.width);
        $("#bgExampleHeight").val(previewConfig.height);

        updatePreviewImage();
    }

    function onSaved() {
        previewUpdate($("#bg-example").val(), $("#bgExampleWidth").val(), $("#bgExampleHeight").val());
        dialog.modal("hide");
        return false;
    }

    function updatePreviewImage() {
        $("#bg-example-preview").prop("src", "/assets/images/" + $("#bg-example").val());
    }

    function presetSize(e){
        var values = $(e.target).text().split("x");
        $("#bgExampleWidth").val(values[0]);
        $("#bgExampleHeight").val(values[1]);

        return false;
    }
</script>